# 网页导出 PDF - Edge 浏览器插件

将当前网页导出为可复制的 PDF 文件，保持文字可选、链接可点击。

## 功能特性

- **保持文字可复制**：使用 html2canvas + jsPDF 技术，文字保留为矢量图形
- **完整页面导出**：自动处理滚动，导出整个网页（不仅是可见区域）
- **智能文件名**：自动使用网页标题作为 PDF 文件名
- **双模式选择**：
  - 原始样式：保留网页原始布局和样式
  - 阅读模式：优化排版，移除广告和导航
- **可配置选项**：控制图片和链接的包含

## 安装方法

### 方式一：开发者模式加载（推荐测试）

1. 打开 Edge 浏览器，访问 `edge://extensions/`
2. 在左下角开启「开发人员模式」
3. 点击「加载解压缩的扩展」按钮
4. 选择本项目的文件夹
5. 扩展图标将出现在工具栏上

### 方式二：打包安装（分发）

1. 在 `edge://extensions/` 页面点击「打包扩展」
2. 选择本项目文件夹
3. 生成 `.crx` 和 `.pem` 文件
4. 用户可拖拽 `.crx` 文件到浏览器安装

### 方式三：Edge 插件商店（正式发布）

1. 注册 [Microsoft Partner Center](https://partner.microsoft.com/) 账号
2. 提交扩展包和相关信息
3. 等待审核通过后上架

## 使用方法

1. 在 Edge 浏览器中打开任意网页
2. 点击工具栏上的「网页导出 PDF」图标
3. 在弹出面板中选择导出模式：
   - **原始样式**：保留网页原始布局和样式
   - **阅读模式**：优化排版，移除广告和导航
4. 配置选项（可选）：
   - 勾选/取消「包含图片」
   - 勾选/取消「保留链接」
5. 点击「导出 PDF」按钮
6. 选择保存位置，PDF 将使用网页标题作为文件名

## 技术实现

### 核心库

- **html2canvas**：将 DOM 元素渲染为 Canvas
- **jsPDF**：生成 PDF 文档
- **html2pdf.js**：整合 html2canvas 和 jsPDF 的高级封装

### 架构

```
manifest.json         # 扩展配置
├── popup.html      # 弹出面板 UI
├── popup.js        # 弹出面板逻辑
├── popup.css       # 弹出面板样式
├── content.js      # 内容脚本（页面内执行）
├── background.js   # 服务工作线程
└── lib/
    └── html2pdf.bundle.min.js  # PDF 生成库
```

### 导出流程

1. **用户触发**：点击导出按钮
2. **内容准备**：根据模式（原始/阅读）准备 DOM
3. **PDF 生成**：使用 html2pdf.js 生成 PDF Blob
4. **文件下载**：通过 Chrome 下载 API 保存文件

## 常见问题

### Q: 为什么有些页面导出效果不理想？

A: 以下情况可能影响导出效果：
- 页面使用了大量 CSS3 动画或变换
- 包含跨域图片且服务器未配置 CORS
- 页面内容动态加载未完成

### Q: 如何处理跨域图片？

A: 插件已启用 `useCORS: true`，但如果图片服务器未配置 CORS 头，图片可能无法显示。这是浏览器安全限制，无法绕过。

### Q: 导出大页面时浏览器卡顿？

A: 大型网页（长页面、大量图片）导出时需要更多内存和处理时间。建议：
- 关闭不必要的标签页释放内存
- 对于超大页面，考虑使用阅读模式精简内容

### Q: PDF 中的文字无法复制？

A: 这是 html2canvas 的限制 - 文字被渲染为图片。如需完全可选文字，建议：
- 使用浏览器自带的「打印为 PDF」功能（Ctrl+P）
- 或使用方案 C（CDP API）的专业版本

## 开发计划

- [ ] 支持批量导出多个标签页
- [ ] 添加自定义页眉/页脚
- [ ] 支持自定义页面尺寸（A4/Letter/Legal）
- [ ] 添加水印功能
- [ ] 支持导出选中部分
- [ ] 集成 OCR 实现图片文字识别

## 许可证

MIT License

## 致谢

- [html2canvas](https://html2canvas.hertzen.com/) - 屏幕截图库
- [jsPDF](https://parall.ax/products/jspdf) - PDF 生成库
- [html2pdf.js](https://ekoopmans.github.io/html2pdf.js/) - 整合封装
